<!DOCTYPE html>
<html lang="en">
<head>
<title>Pes in Action</title>
<script src="src/ace.js" ></script>
<script src="js/pes.pack.js" ></script>
<style type="text/css" media="screen">
    #editor {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        margin: 0 auto;
    }
</style>
</head>
<body style="background-color: rgb(15, 15, 15);">
<a id="fork-me" href="https://github.com/kodcu/pes" target="_blank">
    <img style="position:fixed;top:0;right:18px;border:0;z-index:99999" src="data:image/png;base64,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" alt="Fork me on GitHub">
</a>
<div id="editor">{
  "query": {}
}

{
  "query": {
    "match": {
     "FIELD": "TEXT"
    }
  }
}

{
  q[b[shouldN[o[m],o[m]]]]
}

{
  q[ bool[ shouldN[ o[m] , o[m] ]]]
}


{
  q[m:p[qy,op,ztq],mpp:p[qy]],sz{100},bst,src
}

{
  q[m:p[qy{"selam elastic query"},op{"or"},ztq],mpp],sz,bst,src{["_id","surname"]},exp{true}
}

{
  q[dm[queries[o[mpp],o[mpp]],tb]]
}

{
  q[bool[mustN[o[range[gte{1}]]],shouldN[o[range[gt{1950}]]]]]
}


</div>

<script>
var editor = ace.edit("editor");

editor.setTheme("ace/theme/vibrant_ink");
editor.getSession().setMode("ace/mode/json");
editor.getSession().setUseWrapMode(true);
editor.setHighlightActiveLine(false);
editor.renderer.setShowGutter(true);
editor.setShowPrintMargin(false);
editor.renderer.setScrollMargin(10, 10, 10, 10);
editor.setBehavioursEnabled(true);
editor.session.setFoldStyle("manual");
editor.setOptions({
    enableSnippets: true
});
editor.session.setOption("useWorker", false);

editor.commands.addCommand({
    name: 'query-generate',
    bindKey: {win: 'Tab', mac: 'Tab'},
    exec: function (editor) {
      var cursorPosition = editor.getCursorPosition();
      var currentRow = cursorPosition.row;
      var currentColumn = cursorPosition.column;

      var range = editor.getSelectionRange();
      range.start.row = currentRow;
      range.start.column = 0;
      range.end.row = currentRow;
      range.end.column = currentColumn;

      var textRange = editor.session.getTextRange(range);
      var result = pes.queriesToArray(textRange);
      
      if(result){
        editor.removeToLineStart();

        var newTextRange = textRange.match(/^[\s\t]*/)[0];

        for(var i = 0; i < result.length; i++){
          var text = result[i].replace(/\\\"/g,"\"");

          if(i == 0 && i == result.length - 1)
            editor.insert(text);
          else if(i == 0 && i != result.length - 1)
            editor.insert(text.concat("\n"));
          else if( i != 0 && i == result.length - 1)
            editor.insert(newTextRange + text);
          else
            editor.insert(newTextRange + text.concat("\n"));
        }

        editor.gotoLine(currentRow + 1 , newTextRange.length, true);
      }
      else
        editor.indent();
    },
    readOnly: true
});
</script>
</body>
</html>
